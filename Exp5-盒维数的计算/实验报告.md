# 盒计数法估算分形维数实验报告

## 一、实验目的

1. 理解分形维数（特别是盒维数）的概念和数学原理
2. 掌握盒计数(Box Counting)算法的实现方法
3. 通过编程计算给定分形图像的维数
4. 分析不同参数对计算结果的影响

## 二、实验过程

### 1. 核心算法实现

**图像加载与二值化:**
- 使用Pillow/PIL库读取图像
- 设定阈值进行二值化处理
- 转换为NumPy数组

**盒计数算法实现:**
```python
    height, width = binary_image.shape
    counts = {}

    for size in box_sizes:
        count = 0
        for i in range(0, height, size):
            for j in range(0, width, size):
                patch = binary_image[i:i+size, j:j+size]
                if np.any(patch):  # 如果 patch 中有前景像素
                    count += 1
        counts[size] = count

    return counts

```
数据处理与线性回归:

- 计算log(ε)和log(N(ε))
- 使用numpy.polyfit进行线性拟合
- 计算分形维数 D = -slope
### 2. 实验参数
<img width="793" alt="截屏2025-04-23 15 21 58" src="https://github.com/user-attachments/assets/9dadf6cb-affe-4d24-81fa-af1ad8173115" />



### 3. 遇到的问题与解决
问题：N_epsilons 中包含了0，导致 np.log(N_epsilons) 出现 nan，并且 log_eps 和 log_N 长度不一致。

解决：只保留 N_epsilons > 0 的数据点，保证长度一致且无 log(0)。

## 三、结果展示
### 1. 盒计数结果
![log_log_plot](https://github.com/user-attachments/assets/e120008d-2a49-4439-9501-ff974af72bf8)


关键数据:

- 盒子尺寸(ε): [512, 256, 128,  64,  32,  16,   8,   4,   2,   1]
- 盒子计数(N(ε)): [8,23,67,234,823,2974,10880,40330,150129,568718]
- 拟合斜率: -1.8084851868445495
- 计算得分形维数D: 1.8085
### 2. 与理论值比较
- 理论分形维数: 1.7100
- 计算误差分析: 5.76%（相对误差）
## 四、分析与思考
1. 算法准确性分析
   
   - 盒子尺寸选择对结果的影响
     
     等比数列​​：覆盖多个数量级（如 2^6, 2^5, ..., 2^1），满足分形维数对数关系的假设，避免小尺寸盒子过度密集导致计算冗余。
     
​​     线性数列​​：可能导致数据点在 log-log 图上分布不均，降低回归精度。

   - 图像分辨率对计算精度的影响
     
     ​​低分辨率​​：导致盒子尺寸选择受限（如 max_box_size 过小），无法覆盖足够的数量级。
     
     高分辨率​​：提升细节捕捉能力，但增加计算时间和内存消耗。
     
2. 误差来源分析
   
   - 边界处理的影响
     
     边界处理的影响​​：​​不完整盒子处理​​：代码通过索引截取（i:i+size）自动包含边缘区域，确保所有像素被覆盖。
     
   - 线性拟合的合理性评估

     判定标准​​：相关系数（R²）​​：理想情况下应 >0.99（科赫曲线等标准分形），若 <0.95 需检查数据质量。
     
2. 扩展思考
   
   - 如何改进算法提高计算精度

     动态尺寸生成​​：根据图像尺寸自动选择 min_box_size 和 max_box_size（如 max_box_size = min(h,w)//4）。
     
​​     多尺度回归​​：分段拟合不同尺度范围的分形维数，处理非均匀分形结构。

   - 三维分形维数的计算方法

     盒计数扩展​​：将二维盒子替换为三维立方体，统计覆盖三维分形（如多孔介质）的非空立方体数量。
     
   - 与其他维数计算方法的比较

     ​​盒计数法​​：实现简单，适用性广；对噪声敏感，需高分辨率图像。
     
​​    Hausdorff维数​​：理论严格，精度高；计算复杂，难以实际应用。

    相关维数​​：适合点云数据（如流体轨迹）；需大量样本点，计算耗时。
    
3. 算法优化
   
   - 计算效率优化方案

    早期终止​​：若当前尺寸的盒子数接近图像像素数，提前终止计算。
   
   - 并行计算的可能性
     
     GPU加速​​：将图像数据加载到GPU，利用CUDA并行计算盒子覆盖。

**注：请在每一部分补充您的实验内容、图像、分析和关键代码。**
